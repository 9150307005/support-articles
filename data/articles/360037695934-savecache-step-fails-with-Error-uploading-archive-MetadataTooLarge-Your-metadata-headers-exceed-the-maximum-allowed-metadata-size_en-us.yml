id: 360037695934
url: >-
  https://circleci.zendesk.com/api/v2/help_center/en-us/articles/360037695934.json
html_url: >-
  https://support.circleci.com/hc/en-us/articles/360037695934-save-cache-step-fails-with-Error-uploading-archive-MetadataTooLarge-Your-metadata-headers-exceed-the-maximum-allowed-metadata-size-
author_id: 363669145434
comments_disabled: true
draft: false
promoted: false
position: 0
vote_sum: 1
vote_count: 1
section_id: 115003756627
created_at: '2019-10-31T04:13:26Z'
updated_at: '2020-06-10T17:29:22Z'
name: >-
  save_cache step fails with "Error uploading archive: MetadataTooLarge: Your
  metadata headers exceed the maximum allowed metadata size"
title: >-
  save_cache step fails with "Error uploading archive: MetadataTooLarge: Your
  metadata headers exceed the maximum allowed metadata size"
source_locale: en-us
locale: en-us
outdated: false
outdated_locales: []
edited_at: '2020-06-10T17:29:22Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - caching
  - save_cache
body: >-
  <p>When too many paths are specified to the <strong>save_cache</strong> step,
  the <strong>save_cache</strong> step can fail with error output similar to the
  following:</p>

  <pre>Creating cache archive...<br>Uploading cache archive...<br><br>Error
  uploading archive: MetadataTooLarge: Your metadata headers exceed the maximum
  allowed metadata size<br>status code: 400, request id: 519C2A1181266E40, host
  id:
  A/Ahq11R30q0fAEEaZoUyPnGQgTmrQH3GwprdI0+iaRbAFkwYHDNedpPZ3gFOLUnvAgB28c5954=</pre>

  <p>This is due to a limitation with the size of the metadata associated with
  the cache, as the paths form a part of the metadata. To resolve the error,
  reduce the number of paths specified to the <strong>save_cache</strong> step,
  for example, by splitting the step into multiple <strong>save_cache</strong>
  steps.</p>
