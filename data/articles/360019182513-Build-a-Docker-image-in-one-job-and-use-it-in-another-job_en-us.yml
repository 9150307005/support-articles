id: 360019182513
url: >-
  https://circleci.zendesk.com/api/v2/help_center/en-us/articles/360019182513.json
html_url: >-
  https://support.circleci.com/hc/en-us/articles/360019182513-Build-a-Docker-image-in-one-job-and-use-it-in-another-job
author_id: 25261361207
comments_disabled: true
draft: false
promoted: false
position: 0
vote_sum: -5
vote_count: 25
section_id: 115003755807
created_at: '2019-03-04T08:31:23Z'
updated_at: '2021-02-19T18:51:05Z'
name: Build a Docker image in one job and use it in another job
title: Build a Docker image in one job and use it in another job
source_locale: en-us
locale: en-us
outdated: false
outdated_locales: []
edited_at: '2020-10-22T06:57:53Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - docker
  - workspace
  - docker image
  - artifacts
body: "<h4>Sometimes you may want to build a Docker image in one job, and use it in a downstream job. For small images, you can achieve that by <a href=\"https://circleci.com/docs/2.0/workflows/#using-workspaces-to-share-data-among-jobs\" target=\"_blank\" rel=\"noopener\">using workspaces to share the data among jobs</a>.<span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;\">\_</span>\n</h4>\n<h3><strong>Build job</strong></h3>\n<ul>\n<li>Build the Docker image<br><br>\n</li>\n<li>Save the image to a <em>tar</em> file<br>\n<pre><code>docker save -o &lt;file path for generated tar file&gt; &lt;image name&gt;</code></pre>\n</li>\n<li>\n<span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;\">Use the </span><code style=\"font-size: 15px;\">persist_to_workspace</code><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;\">\_key to make the file\_</span><span style=\"font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;\">available to other jobs.</span>\n</li>\n</ul>\n<p>\_</p>\n<h3><strong>Downstream job(s)</strong></h3>\n<ul>\n<li>Use the <code><span>attach_workspace</span></code>\_key to c<span>onfigure the job(s) to get the previously saved data<br><br></span>\n</li>\n<li>Load the Docker image from the workspace<br>\n<pre><code>docker load -i &lt;path to image tar file&gt;</code></pre>\n</li>\n</ul>\n<p>\_</p>\n<p><em><strong><span class=\"wysiwyg-color-black\">Note</span>:</strong> If your images are large (&gt;~1GB) this will probably not be a great solution. You can try to gzip the images as well or consider strategies to reduce your images size.</em></p>"
