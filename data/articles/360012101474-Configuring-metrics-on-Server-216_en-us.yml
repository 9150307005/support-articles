id: 360012101474
url: >-
  https://circleci.zendesk.com/api/v2/help_center/en-us/articles/360012101474.json
html_url: >-
  https://support.circleci.com/hc/en-us/articles/360012101474-Configuring-metrics-on-Server-2-16
author_id: 26863412148
comments_disabled: true
draft: false
promoted: false
position: 0
vote_sum: 0
vote_count: 2
section_id: 115003327208
created_at: '2018-11-15T17:27:42Z'
updated_at: '2021-01-12T01:52:36Z'
name: Configuring metrics on Server 2.16
title: Configuring metrics on Server 2.16
source_locale: en-us
locale: en-us
outdated: false
outdated_locales: []
edited_at: '2020-10-22T06:59:03Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - server
  - '2.16'
  - metrics
body: "<p>To configure AWS Cloudwatch, Datadog and Custom Metrics on the Server 2.16 installation, you will need to add\_config files for the metric provider.</p>\n<p>You can create a file containing all configs for the output providers named <code>*.conf</code> and place it in <code>/etc/circleconfig/telegraf/</code> like the following:</p>\n<pre class=\"code-yaml\">  - <span class=\"code-keyword\">name: </span>custom_telegraf_config_description\n    <span class=\"code-keyword\">type: </span>label\n    <span class=\"code-keyword\">title: </span>|\n      Files matching `/etc/circleconfig/telegraf/*.conf` on this host will be included with the telegraf configuration.\n      This allows you to specify custom output providers. For more information visit https://circleci.com/docs/<span class=\"code-object\">2</span>.<span class=\"code-object\">0</span>/monitoring/.\n  - <span class=\"code-keyword\">name: </span>custom_telegraf_config_example\n    <span class=\"code-keyword\">title: </span>Example\n    <span class=\"code-keyword\">type: </span>textarea\n    <span class=\"code-keyword\">readonly: </span>true\n    <span class=\"code-keyword\">value: </span>|\n      <span class=\"code-comment\"># SSH into the services host, then add the following to /etc/circleconfig/telegraf/kafka.conf\n</span>      <span class=\"code-comment\"># Afterwards restart the telegraf container with `sudo docker restart telegraf`\n</span>      [[outputs.kafka]]\n        brokers = [<span class=\"code-quote\">\"example.com:<span class=\"code-object\">9092</span>\"</span>]\n        topic = <span class=\"code-quote\">\"circleci\"</span></pre>\n<p>Alternatively, you can create provider-specific configurations. In this example, we are collecting Datadog metrics and will name the file <code>datadog.conf</code> and place it in <code>/etc/circleconfig/telegraf/</code>. The file would look like the following:</p>\n<pre class=\"code-java\">[[outputs.datadog]]\n  apikey = REPLACE_WITH_DATA_DOG_API_KEY\n\n[[outputs.cloudwatch]]\n  access_key = \"\"\n  secret_key = \"\"\n  region = \"\"\n  namespace = \"\" </pre>\n<p>Additional output providers can be found on the <a href=\"https://github.com/influxdata/telegraf/tree/release-1.8/plugins/outputs\">telegraph repo</a>.</p>"
