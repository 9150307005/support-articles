id: 360006357533
url: https://circleci.zendesk.com/api/v2/help_center/ja/articles/360006357533.json
html_url: https://support.circleci.com/hc/ja/articles/360006357533
author_id: 28200990948
comments_disabled: false
draft: false
promoted: false
position: 0
vote_sum: -10
vote_count: 12
section_id: 115003756627
created_at: '2018-06-27T15:52:37Z'
updated_at: '2020-12-10T15:18:51Z'
name: プルリクエストに $CIRCLE_PULL_REQUEST が欠けている
title: プルリクエストに $CIRCLE_PULL_REQUEST が欠けている
source_locale: en-us
locale: ja
outdated: false
outdated_locales: []
edited_at: '2018-11-13T06:15:35Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - pull request
  - pr
  - CIRCLE_PULL_REQUEST
  - missing env var
body: "<p>VCS にコミットを最初にパブリッシュすると、webhook が起動され、CircleCI はコードをダウンロードしてプロジェクトを実行します。 その後でプルリクエストを作成すると、新しいコミット ID が生成されますが、この新しいリクエストは、 CircleCI では期待どおりに実行されません。</p>\n<p>\_</p>\n<p>時間、リソース、コストを節約するため、変更されていないコードは 2 回実行されません。 既にテストに通っている場合、コードを再テストする理由はありません。 この場合、ユーザーのアカウントで実行された元のジョブが更新され、プルリクエストが作成されたことを示します。</p>\n<p>\_</p>\n<p>プルリクエストが作成される前の、ジョブを最初に実行した時点では、`$CIRCLE_PULL_REQUEST` などのデータは存在しません。 プル要求を作成し、それを反映して CircleCI のジョブが更新された後、ジョブが再実行されるとデータが生成されます。</p>\n<p>\_</p>\n<p>プロジェクト設定の Advanced Settings ページで、Only build pull requests (プルリクエストのみをビルドする) を有効にできます。</p>\n<p><img src=\"https://support.circleci.com/hc/article_attachments/360008113373/mceclip1.png\" width=\"224\" height=\"165\"></p>\n<p>\_</p>\n<p><img src=\"https://support.circleci.com/hc/article_attachments/360008069974/mceclip0.png\" width=\"644\" height=\"88\"></p>\n<p>\_</p>\n<p>この場合、`Master` (ユーザーのデフォルトブランチ) へのコミットのみが許可され、プルリクエストが実行されます。 これによって、最初のコミットは実行されず、プルリクエストが作成されたときに正しく実行されるため、上述の問題が解決します。</p>\n<p>\_</p>"
