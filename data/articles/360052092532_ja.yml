id: 360052092532
url: https://circleci.zendesk.com/api/v2/help_center/ja/articles/360052092532.json
html_url: https://support.circleci.com/hc/ja/articles/360052092532
author_id: 405652843914
comments_disabled: true
draft: false
promoted: false
position: 0
vote_sum: 1
vote_count: 1
section_id: 115003580328
created_at: '2020-11-13T19:01:41Z'
updated_at: '2021-02-04T06:02:16Z'
name: config.yml ファイルのみを変更する場合にジョブを停止する
title: config.yml ファイルのみを変更する場合にジョブを停止する
source_locale: en-us
locale: ja
outdated: false
outdated_locales: []
edited_at: '2021-02-04T06:02:16Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - config
  - config.yml
  - condintional
  - skip
body: >-
  <p><code>config.yml</code>
  ファイルを大幅に変更したいものの、変更ごとにはビルドが実行されないようにしたい場合があります。</p><p>そのためには、変更作業をする際に、ワークフローの各ジョブの最初
  (<code>- checkout</code> ステップの後) に以下のコードを追加します。</p><pre
  style="background-color: #f3f3f3;">- run: |    changes=`git show --name-only
  ${CIRCLE_SHA1} | tail -n +7`    if [ "$changes" = ".circleci/config.yml" ];
  then       echo "Only found a configuration change. Stopping build"      
  circleci-agent step halt   
  fi</pre><p>このコードは、コミット内でどのファイルが変更されたかを確認するものです。変更対象が設定ファイルのみだった場合、ジョブは <a
  href="https://circleci.com/docs/ja/2.0/configuration-reference/#step-%E5%86%85%E3%81%8B%E3%82%89%E3%81%AE%E3%82%B8%E3%83%A7%E3%83%96%E3%81%AE%E7%B5%82%E4%BA%86"
  target="_blank" rel="noopener">"circleci-agent step halt"
  コマンド</a>により正常に終了されます。</p><p>設定ファイルの変更が完了したら、上記の実行ステップを削除すれば、通常どおりにビルドのプロセスが開始されます。</p>
