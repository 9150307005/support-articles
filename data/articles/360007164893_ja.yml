id: 360007164893
url: https://circleci.zendesk.com/api/v2/help_center/ja/articles/360007164893.json
html_url: https://support.circleci.com/hc/ja/articles/360007164893
author_id: 26863412148
comments_disabled: false
draft: false
promoted: false
position: 0
vote_sum: 1
vote_count: 1
section_id: 360000059327
created_at: '2018-07-16T23:04:17Z'
updated_at: '2020-10-22T06:58:46Z'
name: ロードバランサーに関連する問題
title: ロードバランサーに関連する問題
source_locale: en-us
locale: ja
outdated: false
outdated_locales: []
edited_at: '2018-11-14T01:54:02Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - ELB
  - server
body: "<p>ロードバランサ― / リバースプロキシの背後で実行した場合、CircleCI で接続失敗のエラーが発生することがあります。 これは、ロードバランサ―で処理される HTTPSのurl を、CircleCI が受信できないためです。 この構成の一般的なパターンは次のとおりです。</p>\n<pre><code>(User) --HTTPS--&gt; (Load Balancer ) --HTTP--&gt; (CircleCI)</code><br><br></pre>\n<p>表示されるエラーは次のようなものです。</p>\n<p>1. GitHub 認証エラー：</p>\n<pre><code>error_description=The+redirect_uri+MUST+match+the+registered+callback+URL+for+this+application.&amp;error_uri=https%3A%2F%2Fdeveloper.github.com%2Fenterprise%2F2.11%2Fv3%2Foauth%2F%23redirect-uri-mismatch</code></pre>\n<p>システム変数 CIRCLE_URL を使用して、HTTPSのurl を定義できます。</p>\n<ol>\n<li>CircleCI で公開されているホスト名を見つけます。これは、:8800/settings で定義されているものと一致している必要があります</li>\n<li>Services node <code>sudo vi /etc/circle-installation-customizations</code> のカスタマイズファイルを編集します</li>\n<li>HTTPS プレフィックスを含むホストへのフルパスを追加します (例：<code>export CIRCLE_URL=\"https://circle.example.com\"</code>)</li>\n<li>\n<a href=\"https://circleci.com/docs/2.0/admin-faq/#how-do-i-debug-the-management-console-replicated\" target=\"_blank\" rel=\"noopener\">Replicated コンソールから、サービスを再起動します。</a>.</li>\n</ol>\n<p>\_</p>\n<p>2. フロントエンドが自動的に更新されません。</p>\n<pre><code class=\"bash\">pusher-94f425ff3b262f615972fa7cdfed368b.min.js:72 WebSocket connection to 'wss://circleci.org.net/app/circle?protocol=7&amp;client=js&amp;version=2.2.4&amp;flash=false' failed: Error during WebSocket handshake: Unexpected response code: 404</code></pre>\n<p>この問題を解決するには、ELB とサービスボックスとの間に SSL 証明書を追加し、ポート 443 とポート 443 を接続します。 通常、ELB はサービスクライアントのポート 443 ではなく、ポート 80 への接続を試みます。</p>\n<pre><code></code></pre>\n<p>\_</p>\n<p>\_</p>"
