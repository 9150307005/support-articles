id: 360052156652
url: >-
  https://circleci.zendesk.com/api/v2/help_center/en-us/articles/360052156652.json
html_url: >-
  https://support.circleci.com/hc/en-us/articles/360052156652-How-to-run-or-skip-a-step-when-a-job-is-rerun-with-SSH
author_id: 405001866574
comments_disabled: false
draft: false
promoted: false
position: 0
vote_sum: 0
vote_count: 0
section_id: 115003755807
created_at: '2020-11-16T18:43:20Z'
updated_at: '2021-02-02T00:06:20Z'
name: How to run or skip a step when a job is rerun with SSH
title: How to run or skip a step when a job is rerun with SSH
source_locale: en-us
locale: en-us
outdated: false
outdated_locales: []
edited_at: '2021-01-27T02:21:55Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - rerun with ssh
body: "<p>You may want to run or skip a step if you rerun your job with SSH. You can do this using <code>netstat</code> to see <span>active TCP connections. When a job is rerun with SSH <code>circleci-agent</code> is the <code>PID/Program Name</code>. You can use the code snippets bellow to conditionally skip or run a step when a job is rerun with SSH.\_\_</span></p>\n<h3><span>To skip a step if the job is rerun with SSH:\_</span></h3>\n<p>\_</p>\n<pre><span> - run: |<br>     if [[ $(netstat -tnlp | grep -F 'circleci-agent') ]] ; then<br>       exit 0;<br>     fi<br>     echo \"commands you want to run when job is NOT rerun with SSH\"</span></pre>\n<p>In the above code, <code>echo \"commands you want to run when job is NOT rerun with SSH\" </code>\_ is only executed when a job is NOT rerun with SSH. When a job is rerun with SSH the step will silently exit with code 0. This means the step will still be successfully run but will not impact the status of your build.\_</p>\n<p>\_</p>\n<h3>Only run a step when a job is rerun with SSH:\_</h3>\n<pre><span> - run: |<br>     if [[ $(netstat -tnlp | grep -F 'circleci-agent') ]] ; then<br>       echo \"commands you want to run ONLY when job is rerun with SSH\"    <br>     fi<br>     exit 0;</span></pre>\n<p>\_</p>"
