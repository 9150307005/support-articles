id: 360009525414
url: https://circleci.zendesk.com/api/v2/help_center/ja/articles/360009525414.json
html_url: https://support.circleci.com/hc/ja/articles/360009525414
author_id: 25261361207
comments_disabled: true
draft: false
promoted: false
position: 0
vote_sum: -47
vote_count: 57
section_id: 115003756627
created_at: '2018-09-21T19:26:10Z'
updated_at: '2020-12-11T22:43:08Z'
name: ローカルで通るテストが CircleCI では失敗する理由
title: ローカルで通るテストが CircleCI では失敗する理由
source_locale: en-us
locale: ja
outdated: false
outdated_locales: []
edited_at: '2020-10-22T01:04:09Z'
user_segment_id: null
permission_group_id: 237867
label_names:
  - test output
  - memory usage
  - memory
  - circleci cli
  - Local Builds
  - OOM
body: >-
  <p>この原因には、以下のような理由が考えられます。</p><ul>

  <li>

  <strong>言語バージョンが異なる</strong>： 利用しているマシンと CircleCI
  で使用されている言語バージョンが同じであることを確認してください</li>

  <li>

  <strong>パッケージのバージョンが異なる</strong>： 構成ファイルでパッケージのバージョンを明示的に指定します。</li>

  <li>

  <strong>タイムゾーンの問題</strong>： 一部のテスト用フレームワークでは、モジュールがタイムゾーンに対応していない可能性があります。
  ローカルのマシンで正しいタイムゾーンが設定されていない場合、一部のテストが失敗する可能性があります。 詳細については、FAQ にある<a
  href="https://circleci.com/docs/2.0/faq/#how-can-i-set-the-timezone-in-docker-images">この質問</a>を参照してください。</li>

  <li>

  <strong>ファイルの順序</strong>： 一部のファイルシステムでは、ディレクトリごとに順序付けされたファイル構造が維持されます。
  このため、すべてのファイルは実行のたびに同じ順序で読み取られます。 しかし、CircleCI のビルドコンテナのファイルシステムには順序がありません。
  実施するテストが、一定の順序で実行した場合にのみ通るようなものであれば、CircleCI では失敗する可能性があります。</li>

  <li>

  <strong>「Out of Memory」エラー</strong>： ビルドコンテナでプロセスによるメモリの使用量が多すぎる場合、 Linux の
  OOM killer により終了されることがあります。 メモリの使用量を確認する場合、<a
  href="https://support.circleci.com/hc/en-us/articles/360043994872"
  target="_self"> How to record a job's memory usage</a>の記事を参照ください。</li>

  <li>

  <strong>起動時間の違い</strong>： Elasticsearch や PostgreSQL などのコンテナは、CircleCI上
  で起動する際に多少の時間を要することがあります。
  テストを実行する前に、サービスが利用可能になるまで明示的に待機することで、この問題を修正できます。</li>

  <li>

  <strong>信頼性の低いサービス</strong>：
  テストでサードパーティー製のサービスを使用する場合、そのサービスが実際に実行されていることを確認してください。</li>

  </ul><p>もし問題が解決できない場合、<a href="https://support.circleci.com/hc/en-us"
  target="_blank" rel="noopener">サポートチケット</a>を登録してください。</p>
